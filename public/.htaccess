<IfModule mod_rewrite.c>
    RewriteEngine On
    
    # --- QUAN TRỌNG: Đã xóa dòng RewriteBase cứng ---
    # Việc xóa RewriteBase giúp code chạy đúng ở bất kỳ tên thư mục nào
    # (Ví dụ: /BTL_Web/public/, /DoAn/public/, hay /Shop/public/ đều được)
    # ------------------------------------------------

    # 1. Chặn truy cập trực tiếp nếu file/thư mục thật sự tồn tại
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    
    # 2. Rule cho TIN TỨC
    RewriteRule ^tin-tuc/([a-zA-Z0-9-]+)$ index.php?url=news/detail&slug=$1 [QSA,L]

    # 3. Rule cho SẢN PHẨM
    # Trang DANH SÁCH
    RewriteRule ^san-pham/?$ index.php?url=products/index [QSA,L]

    # Trang CHI TIẾT
    RewriteRule ^san-pham/(.*)$ index.php?url=products/detail&slug=$1 [QSA,L]

    # 4. Rule cho DANH MỤC
    RewriteRule ^danh-muc/([a-zA-Z0-9-]+)$ index.php?url=products/category&slug=$1 [QSA,L]

    # 5. Mặc định: Chuyển tất cả các request còn lại về index.php
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.+)$ index.php?url=$1 [QSA,L]
</IfModule>